var app=app||{};app.refreshData=function(){var e=null;return function(){e=$("#app-notice-num"),this.rei_prjdbinf_count=function(){}}}(),app.weatherData=function(){var e=null,i=null;return function(){e=$("#weather"),i=_.template($("#weather-template").html()),this.refresh=function(){$.get("/base/weather/",function(t){null!==t&&e.html(i({day:t.results[0].weather_data[0],day1:t.results[0].weather_data[1],day2:t.results[0].weather_data[2]}))})}}}(),app.mainWindow=function(){var e=null,i=null,t=function(){var t=$(window).height();if("function"==typeof e){var n=t-app.ui.header_height-app.ui.main_content_padding[0]-app.ui.main_content_padding[2]-app.ui.box_title;e(n)}if("function"==typeof i){var n=t-app.ui.header_height-app.ui.main_content_padding[0]-app.ui.main_content_padding[2];i(n)}};return new function(){$(window).resize(t),this.gridResize=function(i){e=i,t()},this.mainResize=function(e){i=e,t()},this.clear=function(){e=null,i=null}}}(),app.menus=function(){var e=function(i,t,n){for(var a=null,r=i.length-1;r>=0;r--){if(a=i[r],a.id===t)return a;if(a.depth!==n&&void 0!==a.childs){var s=e(a.childs,t,n);if(void 0!==s)return s}}};return new function(){this.getMenu=function(i,t){if(0===(t=t||1))return app.rootMenu;var n=app.rootMenu.childs;return e(n,i,t)}}}();var TopbarView=Backbone.View.extend({el:".topbar-nav-list",events:{"click li":"link"},initialize:function(){},render:function(){},link:function(e){e.preventDefault();var i,t,n,a,r;i=$(e.currentTarget),t=i.attr("data-menu"),n=i.attr("data-mainMenu"),a=i.children("a").attr("href"),r=app.menus.getMenu(n),app.views.menuView.setSelected(n),app.views.sidebarView.show(r.childs),app.views.sidebarView.setSelected(t),app.views.productView.link(a)}}),MenuView=Backbone.View.extend({el:".header_nav",events:{"click li":"selected"},initialize:function(){this.$ifrInner=$("#ifrInner"),this.$lis=this.$("ul li"),this.render()},render:function(){var e=this.getSelected();return this.link(e),this},selected:function(e){e.preventDefault();var i=$(e.currentTarget),t=i.attr("data-menu");this.setSelected(t),this.link(t)},link:function(e){var i=app.menus.getMenu(e,1);null!==i&&(app.mainWindow.clear(),void 0===i.childs?(app.views.sidebarView.hide(),app.views.productView.link(i.menu_url)):(app.views.sidebarView.show(i.childs),app.views.productView.show(i)))},getSelected:function(){var e,i;return this.$lis.each(function(t,n){i=$(n),i.hasClass("selected")&&(e=i.attr("data-menu"))}),e},setSelected:function(e){this.$lis.each(function(i,t){$(t).attr("data-menu")!==e?$(t).removeClass("selected"):$(t).addClass("selected")})}}),SidebarView=Backbone.View.extend({el:".sidebar",events:{"click .sidebar-fold":"flod","click .sidebar-title":"navFlod","click .nav-item":"selected"},initialize:function(){this.$fold=this.$(".sidebar-fold"),this.$inner=this.$(".sidebar-inner"),this.$main=$(".viewFramework-body"),this.template=_.template($("#sidebar-template").html())},render:function(){return this},flod:function(e){this.$main.hasClass("viewFramework-sidebar-full")?(this.$main.removeClass("viewFramework-sidebar-full"),this.$main.addClass("viewFramework-sidebar-mini")):(this.$main.removeClass("viewFramework-sidebar-mini"),this.$main.addClass("viewFramework-sidebar-full")),window.hasOwnProperty("onMainWinResize")&&onMainWinResize()},navFlod:function(e){var i=$(e.currentTarget),t=i.parent(".sidebar-nav");t.hasClass("sidebar-nav-fold")?t.removeClass("sidebar-nav-fold"):t.addClass("sidebar-nav-fold")},selected:function(e){e.preventDefault();var i=$(e.currentTarget),t=i.attr("data-menu");this.setSelected(t);var n=i.children("a").attr("href");this.linkUrl(n)},linkUrl:function(e){app.views.productView.link(e)},link:function(e){this.setSelected(e),alert("未实现此方法")},show:function(e){this.$inner.html(this.template({e:e})),this.$main.hasClass("viewFramework-sidebar-none")&&(this.$main.removeClass("viewFramework-sidebar-none"),this.$main.addClass("viewFramework-sidebar-full"))},hide:function(){this.$main.removeClass("viewFramework-sidebar-full"),this.$main.removeClass("viewFramework-sidebar-mini"),this.$main.addClass("viewFramework-sidebar-none"),this.$inner.empty()},setSelected:function(e){this.$(".nav-item").each(function(i,t){$(t).attr("data-menu")!==e?$(t).removeClass("selected"):$(t).addClass("selected")})}}),ProductView=Backbone.View.extend({el:".viewFramework-product",events:{"click .product-item":"productSelect","load #ifrInner":"ifrInnerLoaded"},initialize:function(){this.template=_.template($("#product-template").html()),this.$product=this.$(".product"),this.$ifrInner=this.$("#ifrInner"),this.iframe=document.getElementById("ifrInner")},render:function(){},ifrInnerLoaded:function(){},productSelect:function(e){e.preventDefault();var i=$(e.currentTarget),t=i.children("a").attr("href"),n=i.attr("data-menu");app.views.sidebarView.setSelected(n);var a=app.menus.getMenu(n,3);if(void 0===a.childs)this.link(t);else{var t=a.childs[0].menu_url;$(".product1").html(t),this.link(t)}},link:function(e){var i=this.$product;$.get(e,function(e){i.empty(),i.html(e)})},show:function(e){for(var i=[],t=e.childs,n=null,a=0,r=t.length;a<r;a++)if(void 0===t[a].childs)i.push(t[a]);else{n=t[a].childs;for(var s=0,l=n.length;s<l;s++)i.push(n[s])}var d=JSON.parse(e.remark);if(i.length<13)this.$product.html(this.template({e:e,lst:i,feature:d}));else{var i=_.filter(i,function(e){return 1==e.is_important});this.$product.html(this.template({e:e,lst:i,feature:d}))}this.$ifrInner.hide()},hide:function(){},full:function(){},large:function(){},small:function(){}}),AppView=Backbone.View.extend({el:"body",events:{},initialize:function(){},render:function(){return this}}),DropdownView=Backbone.View.extend({el:'[data-toggle="dropdown"]',events:{blur:"show",click:"hide"},initialize:function(){},render:function(){return this},show:function(e){e.preventDefault();var i=$(e.currentTarget).parent(".dropdown");setTimeout(function(){i.removeClass("open")},500)},hide:function(e){e.preventDefault(),$(e.currentTarget).parent(".dropdown").addClass("open")}});