Metadata-Version: 2.0
Name: prometheus-aioexporter
Version: 1.0.2
Summary: Asyncio library for creating Prometheus exporters.
Home-page: https://github.com/albertodonato/prometheus-aioexporter
Author: Alberto Donato
Author-email: alberto.donato@gmail.com
License: LGPLv3+
Description-Content-Type: UNKNOWN
Keywords: prometheus exporter library
Platform: UNKNOWN
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: System Administrators
Classifier: License :: OSI Approved :: GNU Lesser General Public License v3 or later (LGPLv3+)
Classifier: Operating System :: POSIX :: Linux
Classifier: Programming Language :: Python :: 3.5
Classifier: Programming Language :: Python :: 3.6
Classifier: Topic :: Utilities
Classifier: Topic :: Software Development :: Libraries
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Dist: aiohttp (>=2.0.0)
Requires-Dist: prometheus-client
Requires-Dist: toolrack

# prometheus-aioexporter - Asyncio library for creating Prometheus exporters

[![Latest Version](https://img.shields.io/pypi/v/prometheus-aioexporter.svg)](https://pypi.python.org/pypi/prometheus-aioexporter)
[![Build Status](https://travis-ci.org/albertodonato/prometheus-aioexporter.svg?branch=master)](https://travis-ci.org/albertodonato/prometheus-aioexporter)
[![Coverage Status](https://codecov.io/gh/albertodonato/prometheus-aioexporter/branch/master/graph/badge.svg)](https://codecov.io/gh/albertodonato/prometheus-aioexporter)

prometheus-aioexporter is an aysncio-powered library that provides a few
utilities to build [Prometheus](https://prometheus.io/) exporters.


## Install

The library can be installed from pip:

```bash
pip install prometheus-aioexporter
```

## Usage

The library provides a `PrometheusExporterScript` class that serves as an entry
point to create services that export Prometheus metrics via an HTTP endpoint.

An example usage is the following:

```python
from prometheus_aioexporter.script import PrometheusExporterScript


class MyExporter(PrometheusExporterScript):
    """My Prometheus exporter."""

    def configure_argument_parser(self, parser):
        # Additional arguments to the script
        parser.add_argument('an-option', help='an option')
        ...

    def configure(self, args):
        # Save attributes that are needed for later
        self.data = do_stuff()
        ...

    def on_application_startup(self, application):
        # Start other asyncio tasks at application startup
        use(self.data)
        ...

    def on_application_shutdown(self, application):
        # Stop other asyncio tasks at application shutdown
        use(self.data)
        ...


script = MyExporter()
```

The `script` variable can be referenced in `setup.py` to generate the script, like

```python
setup(
    ...,
    entry_points={'console_scripts': ['script = path.to.script:script']},
    ...)
```

`PrometheusExporterScript` provides the following arguments by default, which can be
exended by implementing `configure_argument_parser()`:


```
optional arguments:
  -h, --help            show this help message and exit
  -H HOST, --host HOST  host address to bind (default: localhost)
  -p PORT, --port PORT  port to run the webserver on (default: 9090)
  -L {CRITICAL,ERROR,WARNING,INFO,DEBUG}, --log-level {CRITICAL,ERROR,WARNING,INFO,DEBUG}
                        minimum level for log messages (default: WARNING)
  --process-stats       include process stats in metrics (default: False)
```


