<metal:block xmlns:tal="http://xml.zope.org/namespaces/tal"
             xmlns:metal="http://xml.zope.org/namespaces/metal"
             xmlns:i18n="http://xml.zope.org/namespaces/i18n">


<metal:block metal:define-macro="html_title">
  <h1 class="p-name entry-title" itemprop="headline name"
      tal:define="post context; title options/title"
      tal:condition="python:title and not post.meta('hidetitle')">
    <a href="${post/permalink}" class="u-url">${post/title}</a>
  </h1>
</metal:block>

<metal:block metal:define-macro="html_post_title_author_meta"
        tal:define="_link nocall:options/_link;
                    post context;
                    date_format options/date_format;
                    ">
  <metal:block metal:use-macro="macro:html_title" />
  <div class="metadata meta">
    <p class="byline author vcard">
      <span class="byline-name fn" itemprop="author">
        <a href="${python:_link('author', post.author())}"
           tal:omit-tag="not:options/author_pages_generated">
          ${post/author}
        </a>
      </span>
    </p>
    <p class="dateline">
      <a href="${post/permalink}" rel="bookmark">
        <time class="published dt-published"
              datetime="${python:post.formatted_date('webiso')}"
              itemprop="datePublished"
              title="${python:post.formatted_date(date_format)}">
          ${python:post.formatted_date(date_format)}
        </time>
      </a>
    </p>
    <p class="commentline"
       metal:use-macro="macro:comment-link">
      Comments
    </p>
    <metal:block metal:use-macro="macro:html_sourcelink" />
    <p class="linkline"
       tal:condition="post/meta:link">
      <a href="${post/meta:link" i18n:translate="">Original site</a>
    </p>
  </div>
</metal:block>

<metal:block metal:define-macro="html_post_header">
    <header class="intro-header">
      <metal:block metal:use-macro="macro:html_post_title_author_meta" />
      <metal:block metal:use-macro="macro:post_html_translations" />
    </header>
</metal:block>

<!--! This is only meant to be called through @@macros/post_html_translations -->
<metal:block metal:define-macro="post_html_translations"
             tal:define="post context;
                         lang options/lang">
  <div class="metadata posttranslations translations"
       tal:condition="python:len(post.translated_to) > 1">
    <h3 class="posttranslations-intro" i18n:translate="">Also available in:</h3>
    <tal:block tal:repeat="langname python:sorted(options['translations'])">
      <p tal:condition="python:langname != lang and post.is_translation_available(langname)">
        <a href="${python:post.permalink(langname)}"
           rel="alternate"
           hreflang="${langname}"
           i18n:target="langname"
           i18n:translate="">
          LANGUAGE
        </a>
      </p>
    </tal:block>
  </div>
</metal:block>

<metal:block metal:define-macro="html_sourcelink"
             tal:define="post context;
                         show_sourcelink options/show_sourcelink;
                         ">

  <p class="sourceline" tal:condition="options/show_sourcelink">
    <a href="${post/source_link}" class="sourcelink" i18n:translate="">Source</a>
  </p>
</metal:block>

<metal:block metal:define-macro="html_posts_postlist">
    <ul class="postlist" tal:condition="options/posts">
      <li tal:repeat="post options/posts"
          tal:define="date_format options/date_format">
        <time class="listdate"
              tal:define="date post/formatted_date:?date_format"
              datetime="${post/formatted_date:webiso}"
              title="${date}"
              tal:content="date">2007-10-10</time>
        <a href="${post/permalink}"
           class="listtitle">${post/title}</a>
      </li>
    </ul>
    <p tal:condition="not:options/posts" i18n:translate="">No posts found.</p>
</metal:block>
</metal:block>
