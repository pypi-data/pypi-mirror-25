{% extends CMS_TEMPLATE %}
{% load i18n thumbnail cms_tags pcart_core %}

{% block base_content %}
<h1>{% trans "Cart" %}</h1>

<div>
{% if cart.item_count > 0 %}
<form method="post">
{% csrf_token %}
{% for item in cart.items %}
<div class="row">
    <div class="col-md-3">
    {% with image=item.product.images.first %}
        <a href="{{item.object.get_absolute_url}}">
    {% if image %}<img src="{% thumbnail image.image 200x200 %}" title="{{image}}">{% endif %}
        </a>
    {% endwith %}
    </div>
    <div class="col-md-3">
        <span><a href="{{item.object.get_absolute_url}}">{{item.object.title}}</a></span>
    </div>
    <div class="col-md-3">
    <input class="form-control" type="number" step="1" min="0" name="item-quantity-{{item.id}}" value="{{item.quantity}}">
        &times; {{item.price|money}} = {{item.line_price|money}}</div>
    <div class="col-md-3">
        <button type="submit" name="item-remove-{{item.id}}" class="btn btn-link">{% trans "Remove" %}</button></div>
</div>
{% endfor %}
    <hr>
    <div>
    <h4>{% trans "Subtotal" %}: {{cart.total_price|money}}</h4>
    <p>{% trans "Weight" %}: {{cart.total_weight|weight}}</p>
    </div>
    <div class="form-group">
        <label for="id_note">{% trans "Special instructions for seller" %}</label>
<textarea class="form-control" id="id_note" name="note">{{cart.note}}</textarea>
        </div>
<button type="submit" name="update" class="btn btn-default">{% trans "Update cart" %}</button>
<button type="submit" name="checkout" class="btn btn-primary">{% trans "Proceed to checkout" %}</button>
</form>
{% else %}
<h2>{% trans "It appears that your cart is currently empty!" %}</h2>
<h3>{% trans 'You can continue browsing <a href="/">here</a>.' %}</h3>
{% endif %}
</div>
{% endblock %}