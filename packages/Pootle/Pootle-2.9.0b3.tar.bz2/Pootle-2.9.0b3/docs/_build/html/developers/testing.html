
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Testing &#8212; Pootle 2.9.0b3 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.9.0b3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release Process" href="release.html" />
    <link rel="prev" title="Supported Browsers" href="browsers.html" /> 
  </head>
  <body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="../index.html">Pootle</a>
        <span class="navbar-text pull-left"><b>2.9</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../server/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/upgrading.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/index.html">Administering a server</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
</ul>
</li>
              
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Testing</a><ul>
<li><a class="reference internal" href="#settings-for-tests">Settings for Tests</a></li>
<li><a class="reference internal" href="#writing-tests">Writing Tests</a><ul>
<li><a class="reference internal" href="#what-to-test">What to Test</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fixtures">Fixtures</a><ul>
<li><a class="reference internal" href="#model-fixtures">Model Fixtures</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="browsers.html"
         title="previous chapter">&laquo; Supported Browsers</a></li>
  <li><a href="release.html"
         title="next chapter">Release Process &raquo;</a></li>
            
          </ul>
          <ul class="nav pull-right">
            
              
            
          
            
<form class="navbar-search pull-right" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container content">
   
  <div class="section" id="testing">
<span id="id1"></span><h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Work in progress. For now only Python testing is being added. Future
coverage will include JavaScript code too.</p>
</div>
<p>Pootle tests use the full-featured <a class="reference external" href="http://docs.pytest.org/en/latest/">pytest testing tool</a> and its integration with Django via
<a class="reference external" href="https://pytest-django.readthedocs.io/en/latest/">pytest-django</a>.</p>
<p>To test simply run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">console</span>
</pre></div>
</div>
<blockquote>
<div>(env) $ py.test</div></blockquote>
<p>from the root of the repository. Note that you need to install the testing
requirements into your virtualenv first (<em>requirements/tests.txt</em>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the test runner automatically sets the <a class="reference external" href="https://docs.djangoproject.com/en/1.10/ref/settings/#std:setting-DEBUG" title="(in Django v1.10)"><code class="xref std std-setting docutils literal"><span class="pre">DEBUG</span></code></a> setting to
<code class="docutils literal"><span class="pre">False</span></code>, the static assets need to be collected before running the view
tests. You can run <code class="docutils literal"><span class="pre">make</span> <span class="pre">assets</span></code> for building them.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">py.test</span></code> runner command offers several options which are extended by
plugins as well. Check <a class="reference external" href="http://docs.pytest.org/en/latest/">its documentation</a>
for further details.</p>
<div class="section" id="settings-for-tests">
<h2>Settings for Tests<a class="headerlink" href="#settings-for-tests" title="Permalink to this headline">¶</a></h2>
<p>Some testing-specific settings are loaded from the <em>tests/settings.py</em>
file and override any previous setting you might have set in the
<em>settings/*.conf</em> files.</p>
</div>
<div class="section" id="writing-tests">
<h2>Writing Tests<a class="headerlink" href="#writing-tests" title="Permalink to this headline">¶</a></h2>
<p>Writing new tests is easy. Just write a function whose name starts with
<code class="docutils literal"><span class="pre">test_</span></code> and place it in an appropriate module under the <em>tests/</em>
subdirectory.</p>
<p>You’ll need to use plain Python assertions in test functions. Check pytest’s
documentation for <a class="reference external" href="http://docs.pytest.org/en/latest/assert.html">more information on assertions</a>.</p>
<p>In order to use a fixture, you simply need to reference its name as a
function argument. Pytest does the rest of the magic. There are <a class="reference external" href="http://docs.pytest.org/en/latest/fixture.html">other
ways to reference and use fixtures</a> as well, but most of the time
you’ll find yourself passing them as function arguments.</p>
<div class="section" id="what-to-test">
<h3>What to Test<a class="headerlink" href="#what-to-test" title="Permalink to this headline">¶</a></h3>
<p>You’ll usually want to test model behavior. These tests should test one
function or method in isolation. If you end up needing to test for
multiple things, then you might need to split the function/method into
more specific units. This allows to structure the code better.</p>
<p>When testing models, it’s a suggested practice to avoid DB access because
it makes the tests run slower, so think twice if your test actually needs
DB access. At the same time, pytest-django encourages you to follow these
best practices and disables DB access by default. If your test needs DB
access, you need to explicitly request it by using the
<a class="reference external" href="https://pytest-django.readthedocs.io/en/latest/helpers.html#pytest-mark-django-db-request-database-access">&#64;`pytest.mark.django_db marker</a>.</p>
<p>While testing views/integration tests can also help catch regressions,
they’re slower to run and end up in less useful failures, so better to
write fewer of these.</p>
</div>
</div>
<div class="section" id="fixtures">
<h2>Fixtures<a class="headerlink" href="#fixtures" title="Permalink to this headline">¶</a></h2>
<p>Pootle tests include some pytest fixtures you can reuse. They’re located
in <em>tests/fixtures/</em> and are loaded when the test runner is being set up.</p>
<p>If you have a fixture which is very specific you can place it in a usual
<code class="docutils literal"><span class="pre">conftest.py</span></code> file in its proper context, whereas the aforementioned
directory is meant to be for storing shared or general-purpose fixtures.</p>
<div class="section" id="model-fixtures">
<h3>Model Fixtures<a class="headerlink" href="#model-fixtures" title="Permalink to this headline">¶</a></h3>
<p>Model fixtures are stored under <em>tests/fixtures/models/</em>, and they are
basically factory functions returning an instance of the desired model.
Note that these might depend on other fixtures too.</p>
<p>For now these model fixtures require DB access, but since that’s not what
every single test might need, we might want to combine this with other
more complete solutions like <a class="reference external" href="https://factoryboy.readthedocs.io/en/latest/">factory_boy</a> in the future.</p>
</div>
</div>
</div>


</div>
<hr>

<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top ↑</a></p>
    <ul class="unstyled muted">
      <li><small>
        &copy; 2004-2017.<br/>
      </small></li>
      <li><small>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </small></li>
    </ul>
  </div>
</footer>
  </body>
</html>