

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Large-Scale Machine Reading with Amazon Batch &mdash; INDRA 1.5.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="INDRA 1.5.0 documentation" href="../index.html"/>
        <link rel="up" title="Tutorials" href="index.html"/>
        <link rel="next" title="Assembling everything known about a particular gene" href="gene_network.html"/>
        <link rel="prev" title="Large-Scale Machine Reading with Starcluster" href="machine_reading.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> INDRA
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-python">Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-indra">Installing INDRA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installing-via-github">Installing via Github</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#cloning-the-source-code-from-github">Cloning the source code from Github</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installing-releases-with-pip">Installing releases with pip</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#indra-dependencies">INDRA dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#pysb-and-bionetgen">PySB and BioNetGen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#pyjnius">Pyjnius</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#graphviz">Graphviz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#matplotlib">Matplotlib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#optional-additional-dependencies">Optional additional dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started with INDRA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#importing-indra-and-its-modules">Importing INDRA and its modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#basic-usage-examples">Basic usage examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html#reading-a-sentence-with-trips">Reading a sentence with TRIPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html#reading-a-pubmed-central-article-with-reach">Reading a PubMed Central article with REACH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html#getting-the-neighborhood-of-proteins-from-the-bel-large-corpus">Getting the neighborhood of proteins from the BEL Large Corpus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html#getting-paths-between-two-proteins-from-pathwaycommons-biopax">Getting paths between two proteins from PathwayCommons (BioPAX)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html#constructing-indra-statements-manually">Constructing INDRA Statements manually</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html#assembling-a-pysb-model-and-exporting-to-sbml">Assembling a PySB model and exporting to SBML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">INDRA modules reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/statements.html">INDRA Statements (<code class="docutils literal"><span class="pre">indra.statements</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/sources/index.html">Processors for model input (<code class="docutils literal"><span class="pre">indra.sources</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/sources/bel/index.html">BEL (<code class="docutils literal"><span class="pre">indra.sources.bel</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/bel/index.html#module-indra.sources.bel.bel_api">BEL API (<code class="docutils literal"><span class="pre">indra.sources.bel.bel_api</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/bel/index.html#module-indra.sources.bel.processor">BEL Processor (<code class="docutils literal"><span class="pre">indra.sources.bel.processor</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/sources/biopax/index.html">Biopax (<code class="docutils literal"><span class="pre">indra.sources.biopax</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/biopax/index.html#module-indra.sources.biopax.biopax_api">Biopax API (<code class="docutils literal"><span class="pre">indra.sources.biopax.biopax_api</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/biopax/index.html#module-indra.sources.biopax.processor">Biopax Processor (<code class="docutils literal"><span class="pre">indra.sources.biopax.processor</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/biopax/index.html#module-indra.sources.biopax.pathway_commons_client">Pathway Commons Client (<code class="docutils literal"><span class="pre">indra.sources.biopax.pathway_commons_client</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/sources/reach/index.html">REACH (<code class="docutils literal"><span class="pre">indra.sources.reach</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/reach/index.html#module-indra.sources.reach.reach_api">REACH API (<code class="docutils literal"><span class="pre">indra.sources.reach.reach_api</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/reach/index.html#module-indra.sources.reach.processor">REACH Processor (<code class="docutils literal"><span class="pre">indra.sources.reach.processor</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/reach/index.html#module-indra.sources.reach.reach_reader">REACH reader (<code class="docutils literal"><span class="pre">indra.sources.reach.reach_reader</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/sources/trips/index.html">TRIPS (<code class="docutils literal"><span class="pre">indra.sources.trips</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/trips/index.html#module-indra.sources.trips.trips_api">TRIPS API (<code class="docutils literal"><span class="pre">indra.sources.trips.trips_api</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/trips/index.html#module-indra.sources.trips.processor">TRIPS Processor (<code class="docutils literal"><span class="pre">indra.sources.trips.processor</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/trips/index.html#module-indra.sources.trips.trips_client">TRIPS Client (<code class="docutils literal"><span class="pre">indra.sources.trips.trips_client</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/sources/ndex_cx/index.html">NDEx CX API (<code class="docutils literal"><span class="pre">indra.sources.ndex_cx_api</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/sources/ndex_cx/index.html#ndex-cx-processor-indra-sources-ndex-cx-processor">NDEx CX Processor (<code class="docutils literal"><span class="pre">indra.sources.ndex_cx.processor</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/databases/index.html">Database clients (<code class="docutils literal"><span class="pre">indra.databases</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.hgnc_client">HGNC client (<code class="docutils literal"><span class="pre">indra.hgnc_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.uniprot_client">Uniprot client (<code class="docutils literal"><span class="pre">indra.databases.uniprot_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.chebi_client">ChEBI client (<code class="docutils literal"><span class="pre">indra.databases.chebi_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.biogrid_client">BioGRID client (<code class="docutils literal"><span class="pre">indra.databases.biogrid_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.context_client">Cell type context client (<code class="docutils literal"><span class="pre">indra.databases.context_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.relevance_client">Network relevance client (<code class="docutils literal"><span class="pre">indra.databases.relevance_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.ndex_client">NDEx client (<code class="docutils literal"><span class="pre">indra.databases.ndex_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/databases/index.html#module-indra.databases.cbio_client">cBio portal client (<code class="docutils literal"><span class="pre">indra.databases.cbio_client</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/literature/index.html">Literature clients (<code class="docutils literal"><span class="pre">indra.literature</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/literature/index.html#module-indra.literature.pubmed_client">Pubmed client (<code class="docutils literal"><span class="pre">indra.literature.pubmed_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/literature/index.html#module-indra.literature.pmc_client">Pubmed Central client (<code class="docutils literal"><span class="pre">indra.literature.pmc_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/literature/index.html#module-indra.literature.crossref_client">CrossRef client (<code class="docutils literal"><span class="pre">indra.literature.crossref_client</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/literature/index.html#module-indra.literature.elsevier_client">Elsevier client (<code class="docutils literal"><span class="pre">indra.literature.elsevier_client</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/preassembler/index.html">Preassembly (<code class="docutils literal"><span class="pre">indra.preassembler</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/preassembler/index.html#module-indra.preassembler">Preassembler (<code class="docutils literal"><span class="pre">indra.preassembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/preassembler/index.html#module-indra.preassembler.grounding_mapper">Entity grounding curation and mapping (<code class="docutils literal"><span class="pre">indra.preassembler.grounding_mapper</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/preassembler/index.html#module-indra.preassembler.sitemapper">Site curation and mapping (<code class="docutils literal"><span class="pre">indra.preassembler.sitemapper</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/preassembler/index.html#module-indra.preassembler.hierarchy_manager">Hierarchy manager (<code class="docutils literal"><span class="pre">indra.preassembler.hierarchy_manager</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/belief/index.html">Belief Engine (<code class="docutils literal"><span class="pre">indra.belief</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/mechlinker/index.html">Mechanism Linker (<code class="docutils literal"><span class="pre">indra.mechlinker</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/assemblers/index.html">Assemblers of model output (<code class="docutils literal"><span class="pre">indra.assemblers</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/pysb_assembler.html">Executable PySB models (<code class="docutils literal"><span class="pre">indra.assemblers.pysb_assembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/cx_assembler.html">Cytoscape networks (<code class="docutils literal"><span class="pre">indra.assemblers.cx_assembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/english_assembler.html">Natural language (<code class="docutils literal"><span class="pre">indra.assemblers.english_assembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/graph_assembler.html">Node-edge graphs (<code class="docutils literal"><span class="pre">indra.assemblers.graph_assembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/sif_assembler.html">SIF / Boolean networks (<code class="docutils literal"><span class="pre">indra.assemblers.sif_assembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/index_card_assembler.html">MITRE &#8220;index cards&#8221; (<code class="docutils literal"><span class="pre">indra.assemblers.index_card_assembler</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/assemblers/sbgn_assembler.html">SBGN output (<code class="docutils literal"><span class="pre">indra.assemblers.sbgn_assembler</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/explanation/index.html">Explanation (<code class="docutils literal"><span class="pre">indra.explanation</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/explanation/index.html#module-indra.explanation.model_checker">Check whether a rule-based model satisfies a property (<code class="docutils literal"><span class="pre">indra.explanation.model_checker</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/tools/index.html">Tools (<code class="docutils literal"><span class="pre">indra.tools</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/tools/index.html#module-indra.tools.assemble_corpus">Run assembly components in a pipeline (<code class="docutils literal"><span class="pre">indra.tools.assemble_corpus</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/tools/index.html#module-indra.tools.gene_network">Build a network from a gene list (<code class="docutils literal"><span class="pre">indra.tools.gene_network</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/tools/index.html#module-indra.tools.executable_subnetwork">Build an executable model from a fragment of a large network (<code class="docutils literal"><span class="pre">indra.tools.executable_subnetwork</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/tools/index.html#module-indra.tools.incremental_model">Build a model incrementally over time (<code class="docutils literal"><span class="pre">indra.tools.incremental_model</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nl_modeling.html">Using natural language to build models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nl_modeling.html#read-indra-statements-from-a-natural-language-string">Read INDRA Statements from a natural language string</a></li>
<li class="toctree-l3"><a class="reference internal" href="nl_modeling.html#assemble-the-indra-statements-into-a-rule-based-executable-model">Assemble the INDRA Statements into a rule-based executable model</a></li>
<li class="toctree-l3"><a class="reference internal" href="nl_modeling.html#exporting-the-model-into-other-common-formats">Exporting the model into other common formats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="machine_reading.html">Large-Scale Machine Reading with Starcluster</a><ul>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#install-reach">Install REACH</a></li>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#install-amazon-s3-support">Install Amazon S3 support</a></li>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#install-other-dependencies">Install other dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#assemble-a-corpus-of-pmids">Assemble a Corpus of PMIDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#process-the-papers-with-reach">Process the papers with REACH</a></li>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#extract-indra-statements-from-the-reach-output-on-s3">Extract INDRA Statements from the REACH output on S3</a></li>
<li class="toctree-l3"><a class="reference internal" href="machine_reading.html#running-the-whole-pipeline-with-one-script">Running the whole pipeline with one script</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Large-Scale Machine Reading with Amazon Batch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it Works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gene_network.html">Assembling everything known about a particular gene</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gene_network.html#collect-mechanisms-from-pathwaycommons-and-the-bel-large-corpus">Collect mechanisms from PathwayCommons and the BEL Large Corpus</a></li>
<li class="toctree-l3"><a class="reference internal" href="gene_network.html#collect-a-list-of-publications-that-discuss-the-gene-of-interest">Collect a list of publications that discuss the gene of interest</a></li>
<li class="toctree-l3"><a class="reference internal" href="gene_network.html#get-the-full-text-or-abstract-corresponding-to-the-publications">Get the full text or abstract corresponding to the publications</a></li>
<li class="toctree-l3"><a class="reference internal" href="gene_network.html#read-the-content-of-the-publications">Read the content of the publications</a></li>
<li class="toctree-l3"><a class="reference internal" href="gene_network.html#combine-all-statements-and-run-pre-assembly">Combine all statements and run pre-assembly</a></li>
<li class="toctree-l3"><a class="reference internal" href="gene_network.html#assemble-the-statements-into-a-network-model">Assemble the statements into a network model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rest_api.html">REST API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rest_api.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rest_api.html#launching-the-rest-service">Launching the REST service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rest_api.html#documentation">Documentation</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">INDRA</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Tutorials</a> &raquo;</li>
      
    <li>Large-Scale Machine Reading with Amazon Batch</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/machine_reading_aws.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="large-scale-machine-reading-with-amazon-batch">
<h1>Large-Scale Machine Reading with Amazon Batch<a class="headerlink" href="#large-scale-machine-reading-with-amazon-batch" title="Permalink to this headline">¶</a></h1>
<p>The following doc describes the steps involved in reading a large numbers of
papers in parallel on Amazon EC2 using REACH, caching the JSON output on Amazon
S3, processing the REACH output into INDRA Statements, and then caching the
statements also on S3. Prerequisites for doing the following are:</p>
<ul class="simple">
<li>An Amazon S3 bucket containing full text contents for papers, keyed by
Pubmed ID (creation of this S3 repository will be described in another
tutorial).</li>
<li>Amazon AWS credentials for using AWS Batch.</li>
<li>A corpus of PMIDs (see <em>Large-Scale Machine Reading with Starcluster</em> for
information on how to assemble this)</li>
<li>Optional: Elsevier text and data mining API key and institution key for
subscriber access to Elsevier full text content.</li>
</ul>
<div class="section" id="how-it-works">
<h2>How it Works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">The reading pipeline makes use of a Docker image that contains INDRA and all
necessary dependencies, including REACH, Kappa, PySB, etc. The Docker file
for this image is available at: <a class="reference external" href="https://github.com/johnbachman/indra_docker">https://github.com/johnbachman/indra_docker</a>.</p>
</li>
<li><p class="first">The INDRA Docker image is built by AWS Codebuild and pushed to Amazon&#8217;s
EC2 Container Service (ECS), where it is available via the Repository URI:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">292075781285.</span><span class="n">dkr</span><span class="o">.</span><span class="n">ecr</span><span class="o">.</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">indra</span>
</pre></div>
</div>
</li>
<li><p class="first">An AWS Batch <em>Compute Environment</em> named &#8220;run_reach&#8221; is configured to use
this Docker image for handling AWS jobs. This compute environment is configured
to use only Spot instances with a maximum spot price of 40% of the on-demand
price, and 16 vCPUs.</p>
</li>
<li><p class="first">An AWS <em>Job Queue</em>, &#8220;run_reach_queue&#8221;, is configured to use instances of the
&#8220;run_reach&#8221; Compute Environment.</p>
</li>
<li><p class="first">An AWS <em>Job Definition</em>, &#8220;run_reach_jobdef&#8221;, is configured to run in the
&#8220;run_reach_queue&#8221;, and to use 16 vCPUs and 30GiB of RAM.</p>
</li>
<li><p class="first">Reading jobs are submitted by running the script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">indra</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">submit_reading_pipeline_aws</span> <span class="n">read</span> <span class="p">[</span><span class="n">args</span><span class="p">]</span>
</pre></div>
</div>
<p>which, given a list of PMIDs:</p>
<ul class="simple">
<li>Copies the PMID list to the key <code class="docutils literal"><span class="pre">reading_results/[job_name]/pmids</span></code> on
Amazon S3</li>
<li>Breaks the list up into chunks (e.g., of 3000 PMIDs) and submits an AWS
Batch job for each (using the &#8220;run_reach_jobdef&#8221; definition as a template).</li>
</ul>
</li>
<li><p class="first">The ECS instance created by the AWS Batch job runs the script
<code class="docutils literal"><span class="pre">indra.tools.reading.run_reach_on_pmids_aws</span></code>, which:</p>
<ul class="simple">
<li>Checks for cached content on Amazon S3</li>
<li>If the PMID has not been read by the current version of REACH, checks for
content</li>
<li>If the content is not available, downloads the content using the INDRA
literature client, and caches on S3</li>
<li>The content to be read is downloaded to the <code class="docutils literal"><span class="pre">/tmp</span></code> directory of the
instance</li>
<li>REACH is run using the command-line interface (RunReachCLI), and configured
to read the papers in the <code class="docutils literal"><span class="pre">/tmp</span></code> directory using all of the vCPUs on the
instance</li>
<li>When done, the result REACH JSON in the output folder is uploaded to S3</li>
<li>The JSON for both the previously and newly read papers is processed in
parallel to INDRA Statements</li>
<li>The resulting subset of statements for the given range of papers is cached
on S3 at <code class="docutils literal"><span class="pre">reading_results/[job_name]/stmts/[start_ix]_[end_ix].pkl</span></code>. This
set of statements takes the form of a pickled (protocol 3) Python dict
with PMIDs as keys and lists of INDRA Statements as values.</li>
<li>In addition, information about the sources of content available for each
PMID is cached for each PMID subset at
<code class="docutils literal"><span class="pre">reading_results/[job_name]/content_types/[start_ix]_[end_ix].pkl</span></code>.</li>
</ul>
</li>
<li><p class="first">When the reading jobs for each of the subsets of PMIDs have been completed
and cached on S3, the final combined set of statements (and combined
information on content sources) can be assembled using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">indra</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">submit_reading_pipeline_aws</span> <span class="n">combine</span> <span class="p">[</span><span class="n">job_name</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li>This script submits an AWS batch job for a machine with 1 vCPU but a large
amount of memory (60GiB)</li>
<li>The job runs the script <code class="docutils literal"><span class="pre">indra.tools.reading.assemble_reach_stmts_aws</span></code>,
which unpickles the results from all of the PMID subsets, combines them,
and stores them on S3</li>
<li>The resulting files are obtainable from S3 at
<code class="docutils literal"><span class="pre">reading_results/[job_name]/stmts.pkl</span></code> and
<code class="docutils literal"><span class="pre">reading_results/[job_name]/content_types.pkl</span></code>.</li>
</ul>
</li>
<li><p class="first">To run the entire pipeline, where the assembly of the combined set of
statements is automatically performed after the reading step is completed,
run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">indra</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">submit_reading_pipeline_aws</span> <span class="n">full</span> <span class="p">[</span><span class="n">args</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gene_network.html" class="btn btn-neutral float-right" title="Assembling everything known about a particular gene" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="machine_reading.html" class="btn btn-neutral" title="Large-Scale Machine Reading with Starcluster" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, B. M. Gyori, J. A. Bachman.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>